function Open(e){window.location=e}function OpenTab(e){var t=window.open(e,"_blank");t.focus()}function ucwords(e){return(e+"").replace(/^([a-z\u00E0-\u00FC])|\s+([a-z\u00E0-\u00FC])/g,function(e){return e.toUpperCase()})}function setTitle(e){document.title=e}function replaceAll(e,t,n){if(e&&t&&n){return e.replace(new RegExp(t,"g"),n)}else{return e}}function getOccurence(e,t){for(var n=0,r=e.length;n<r;n++){if(e[n][0]===t){return n}}return-1}function setLangIcon(){var e=new Array("jp","en","de","fr");var t=new Array("日本語","English","Deutsch","Français");var n=e[Cookies.getCookie("XIVMODELS:Language")];var r=t[Cookies.getCookie("XIVMODELS:Language")];$("#selected_language_text").html(r);$(".selected_language").attr("src","images/language/"+n+".png");$(".selected_language").animate({opacity:1},250)}function initDropDowns(){$(".add-dropdown-zone").hover(function(){var e=$(this).data("menu");$("#"+e).stop(!0,!0).show()},function(){var e=$(this).data("menu");$("#"+e).stop(!0,!0).hide()})}function hideDropDown(){$(".hud-dropdown").hide();$(".hud-dropdown-button-hover").removeClass("hud-dropdown-button-hover")}$(document).ready(function(){$(".tooltip").uitooltip();$(".background").minicolors({change:function(e,t){$("html").css({background:"none","background-color":e})}});$("select").keydown(function(){$(this).change()});$(".player-select").change(function(){Menu.changeSelect($(this),"item")});$(".monster-select").change(function(){Menu.changeSelect($(this),"monster")});$(".primal-select").change(function(){Menu.changeSelect($(this),"primal")});$(".summon-select").change(function(){Menu.changeSelect($(this),"summon")});$(".pet-select").change(function(){Menu.changeSelect($(this),"pet")});$(".beastman-select").change(function(){Menu.changeSelect($(this),"beastman")});$(".mount-select").change(function(){Menu.changeSelect($(this),"mount")});$(".race-switch").change(function(){for(var e in model){if(model[e]["model"]&&model.hasOwnProperty(e)){model_viewer.detach(model[e]["model"]);model[e]["model"]=model_viewer.attach(Menu.adaptToRace(model[e]["model_path"]));if(model[e]["material"]){model[e]["model"].set_material_version(Menu.adaptToRace(model[e]["material"]))}}}});doWork();initDropDowns()});var onresizeTimer;window.onresize=function(e){$(".welcome_window").center();$(".donation_window").center();ContentStatus.setStatus(null,true);window.clearTimeout(onresizeTimer);onresizeTimer=window.setTimeout(function(){var e=document.getElementById("webgl_canvas");e.width=window.outerWidth;e.height=window.innerHeight;camera.updateProjectionMat(e);ContentStatus.setStatus()},300)};var ContentStatus={setStatus:function(e,t){if(e||t){if(t){$(".status").html('<img src="images/loading2.gif" />').fadeIn(300)}else{$(".status").html('<div class="status-text">'+e+"</div>").fadeIn(300)}}else{$(".status").fadeOut(200)}},showLoading:function(){$(".loading").html("").fadeIn(200)},hideLoading:function(){$(".loading").fadeOut(200,function(){$(this).html("")})},addLoading:function(e,t,n){if(e&&t&&n>1){if(!$(".loading").is(":visible")){ContentStatus.showLoading()}$(".loading").append('<div class="loading-'+t+'" style="padding:5px;"> 					<div style="margin-bottom:8px;"> 					<span class="loading-title">'+ucwords(e)+'</span> 					<span class="loading-info" style="float:right;"><span class="'+t+'-done"></span><span style="opacity:0.5;">/</span><span class="'+t+'-total"></span></span> 					</div> 					<div class="progress_bar" style="width: 207px;"><div class="'+t+'-progress progress_bar_fill"></div></div> 				</div>')}},nullClass:function(e){$(".loading").removeClass("loading-"+e);$(".loading").removeClass(e+"-done");$(".loading").removeClass(e+"-total");$(".loading").removeClass(e+"-progress")},setLoadingText:function(e){$(".loading").html('<div style="padding:10px;">'+e+"</div>")},removeLoading:function(e){$(".loading-"+e).slideUp(200)}};var Menu={active:"home",searchTimeout:{},loadedType:{},grouping_entities:["beastman","mount"],set:function(e){$(".menu-"+Menu.active).removeClass("active");$(".tab-"+Menu.active).hide();$(".menu-"+e).addClass("active");$(".tab-"+e).show();Menu.active=e},changeSelect:function(e,t){clearTimeout(Menu.searchTimeout);Menu.searchTimeout=setTimeout(function(){var t=$(e).find(":selected").text();var n=$(e).val();if(n!="remove"){n=JSON.parse(window.atob($(e).val()));if(Menu.loadedType!=n[0]["type"]||$.inArray(n[0]["type"].toLowerCase(),Menu.grouping_entities)!=-1)Menu.clearScene();Menu.loadEntities(n)}else{var r=$(e).data("type");Menu.clearScene(r);Menu.buildUrl()}},300)},buildUrl:function(e){var t=[];var n={};for(var r in model){if(model.hasOwnProperty(r)&&model[r]){t.push([model[r]["id"],model[r]["type"]]);n=model[r]}}if(t.length>1&&$.inArray(n["type"].toLowerCase(),Menu.grouping_entities)==-1){var i="group/"+JSON.stringify(window.btoa(t));setTitle("Final Fantasy XIV : A Realm Reborn (FFXIV ARR) Model Viewer");url.set(i.replace(/"/g,""),false)}else if(t.length==1&&n||$.inArray(n["type"].toLowerCase(),Menu.grouping_entities)!=-1){setTitle(n["name"]+" - Final Fantasy XIV : A Realm Reborn (FFXIV ARR) Model Viewer");url.set(n["type"].toLowerCase()+"/"+n["id"]+"/"+replaceAll(n["name"]," ","-"),false)}else{setTitle("Final Fantasy XIV : A Realm Reborn (FFXIV ARR) Model Viewer");url.set("",false)}},clearScene:function(e){for(var t in model){if(t==e||e==undefined){if(model[t]["model"])model_viewer.detach(model[t]["model"]);delete model[t]}}},loadEntities:function(e){for(var t in e){if(e.hasOwnProperty(t)&&e[t]){var n=e[t];var r=n["slot"];Menu.clearScene(r);model[r]={model_path:n["model"],material:n["material"],slot:r,type:n["type"],name:n["name"],icon:n["icon"],id:n["id"]};Menu.loadModel(r);Menu.buildUrl()}}},loadModel:function(e){Menu.loadedType=model[e]["type"].toUpperCase();model[e]["model"]=model_viewer.attach(Menu.adaptToRace(model[e]["model_path"]));if(model[e]["material"]){model[e]["model"].set_material_version(model[e]["material"])}if($(".xivdb-info").children().length>=8)$(".xivdb-info a:last-child").remove();var t=true;if($.inArray(model[e]["type"].toLowerCase(),Menu.grouping_entities)!=-1&&model[e]["slot"].toLowerCase()!="body")t=false;if(t){$(".xivdb-info").prepend('<a href="?'+model[e]["type"]+"/"+model[e]["id"]+"/"+replaceAll(model[e]["name"]," ","-")+'"><img src="http://xivmodels.com/'+model[e]["icon"].toLowerCase()+'" class="hud-page-icon tooltip" data-tooltip="'+model[e]["name"]+'" style="float:none;" /></a>');$(".tooltip").uitooltip();History.add("models_history",model[e]["id"],model[e]["name"],model[e]["icon"],model[e]["type"])}},adaptToRace:function(e){if($(".race-switch").val())return replaceAll(e,"c0101",$(".race-switch").val());else return e}};var Display={setBG:function(e){$("html").css({background:"url("+e+")","background-position":"center center","background-size":"100% 100%"})}};var url={get:function(){return document.URL},set:function(e,t){if(t){window.history.replaceState("","","?"+e)}else{window.history.pushState("","","?"+e)}}};var History={size:6,add:function(e,t,n,r,i){var s=Cookies.get(e);if(s){var s=JSON.parse(s),o=getOccurence(s,t);-1<o&&s.splice(o,1);s.push([t,n,r,i]);s.reverse();s=s.splice(0,History.size);s.reverse();Cookies.set(e,JSON.stringify(s))}else{Cookies.set(e,JSON.stringify([[t,n,r,i]]))}},get:function(e){return(e=Cookies.get(e))?JSON.parse(e):!1}};var Cookies={expires:{"default":365},set:function(e,t){$.cookie(e,t,{expires:Cookies.expires.default})},get:function(e){return $.cookie(e)},getAll:function(){return $.cookie()},remove:function(e){$.removeCookie(e)},setCookie:function(e,t){Cookies.set(e,t)},getCookie:function(e){return Cookies.get(e)},deleteCookie:function(e){Cookies.remove(e)}};(function(e){e.fn.uitooltip=function(){return this.each(function(){var t=e(this).data("tooltip");var n=e(this).data("tooltip-style");var r="tooltip-style";if(n){r=r+"-"+n}if(t!=undefined){e(this).hover(function(t){e("#"+r).remove();var n=e(this).data("tooltip");var i=t.pageX+15;var s=t.pageY+15;e("body").append("<div id='"+r+"' style='position: absolute; z-index: 9999; display: none;'>"+n+"</div>");var o=e("#"+r).width();e("#"+r).width(o);e("#"+r).css("left",i).css("top",s).show()},function(){e("#"+r).remove()});e(this).mousemove(function(t){var n=t.pageX+15;var i=t.pageY+15;var s=e("#"+r).outerWidth(true)+10;var o=e("#"+r).outerHeight(true);if(n+s>e(window).scrollLeft()+e(window).width())n=t.pageX-s;if(e(window).height()+e(window).scrollTop()<i+o)i=t.pageY-o;e("#"+r).css("left",n).css("top",i).show()})}})}})(jQuery);jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,($(window).height()-$(this).outerHeight())/2+$(window).scrollTop())+"px");this.css("left",Math.max(0,($(window).width()-$(this).outerWidth())/2+$(window).scrollLeft())+"px");return this};